---
title: "文档解析 - Parse"
description: "了解 xParse 中的文档解析模块，将非结构化文档转换为结构化元素"
---

## 概念

文档解析是将非结构化文件内容提取并转换为结构化[文档元素](/pipeline/elements-metadata)的过程。

与简单将文件视为纯文本不同，xParse 通过解析保留了文件的语义结构，让您能够在后续处理流程中进行更灵活的控制，并能充分考虑文件的结构特点。同时，通过将不同文件格式统一转换为 xParse 的元素类型，无论源文件是什么格式，您都可以在下游采用相同的方式处理。

## 用途

文档解析的主要用途：

- **内容提取**：从 PDF、Word、图片等多种格式中提取文本和其他内容
- **结构化转换**：将提取的内容转换为标准化的文档元素，便于后续处理
- **语义保留**：保留文档的语义结构，如标题、段落、表格等
- **格式统一**：将不同格式的文档统一转换为相同的元素结构

## 参数说明

### provider

**类型**: `string` <br />
**必填**: 是 <br />
**默认值**: `textin` <br />
**可选值**: `textin` | `textin-lite` | `mineru` | `paddle` 

Parser 解析引擎选择：

- **textin**: TextIn 自研高性能解析引擎，适合大多数场景（推荐）
- **textin-lite**: TextIn 全文识别解析引擎，适合纯文本、电子档 pdf 等场景，速度更快，价格更低
- **mineru**: MinerU 解析引擎，在学术论文等场景表现优异
- **paddle**: PaddleOCR 解析引擎，在多语言和复杂文档场景（如PPT）表现优异

更多先进引擎正在陆续支持中，敬请期待。

### pdf_pwd

**类型**: `string` <br />
**必填**: 否 

PDF 密码。当 PDF 为加密文档时，需要提供密码。

<Warning>
**安全提示**：对前端封装该接口参数时，需要自行对密码进行安全防护。
</Warning>

### page_ranges

**类型**： `string` <br /> 
**必填**: 否 

指定解析页码范围，格式为逗号分隔的字符串。

- **15**: 只解析第 15 页
- **20-25**: 解析第 20 页到第 25 页
- **1,3,5-7**: 解析第 1、3、5、6、7 页

### crop_dewarp

**类型**: `integer` <br /> 
**必填**: 否 <br />
**默认值**: `0` <br />
**可选值**: `0` | `1` <br />

是否进行切边矫正预处理，默认为0，不进行切边矫正。

- **0**: 不进行切边矫正
- **1**: 进行切边矫正

### remove_watermark

**类型**: `integer` <br />
**必填**: 否 <br />
**默认值**: `0` <br />
**可选值**: `0` | `1` 

是否进行去水印预处理，默认为0，不去水印。

- **0**: 不去水印
- **1**: 去水印

### Textin 引擎特定参数（provider = textin 时）

#### parse_mode

**类型**: `string` <br />
**必填**: 否 <br />
**默认值**: `scan` <br />
**可选值**: `auto` | `scan` 

pdf文档的解析模式，默认为scan模式。图片不用设置，均默认按scan模式处理。
- auto: 综合文字识别和解析模式：对pdf电子档解析，会直接提取pdf中的文字
- scan: 仅按文字识别模式：将pdf当成图片处理

{/* #### image_output_type

**类型**: `string`  
**必填**: 否  
**默认值**: `"default"`  
**可选值**: `base64str` | `default`

指定返回的图片对象输出类型。

- **base64str**: 指定所有图片对象为 base64 字符串，适用于没有云存储的用户，但是引擎返回结果体积会很大
- **default**: 指定子图片对象为图片 URL，页图片对象为图片 ID */}

#### underline_level

**类型**: `integer` <br />
**必填**: 否 <br />
**默认值**: `0` <br />
**可选值**: `0` | `1` | `2` 

控制下划线识别范围。

- **0**: 不识别
- **1**: 仅识别无文字的下划线（仅 scan 模式可用）
- **2**: 识别全部的下划线（仅 scan 模式可用）

#### apply_chart

**类型**: `integer` <br />
**必填**: 否 <br />
**默认值**: `0` <br />
**可选值**: `0` | `1` 

图表识别。是否开启图表识别，开启图表识别会将识别到的图表以表格形式输出。

- **0**: 不开启图表识别
- **1**: 开启图表识别

### MinerU 引擎特定参数（provider = mineru 时）

xParse 支持 MinerU vlm 模型，除了上述通用参数，xParse 会将用户提交的其余参数透传给 MinerU 引擎，具体参数请参考[MinerU API 文档](https://mineru.net/apiManage/docs)。

### Paddle 引擎特定参数（provider = paddle 时）

xParse 支持 PaddleOCR-VL 模型，除了上述通用参数，xParse 会将用户提交的其余参数透传给 PaddleOCR 引擎，具体参数请参考[PaddleOCR API 文档](https://ai.baidu.com/ai-doc/AISTUDIO/2mh4okm66)。

## 输出结果说明

parse 阶段返回一个[文档元素](/pipeline/elements-metadata)列表。每个元素包含以下字段：

- **element_id**: 元素的唯一标识符（文本+坐标+页码+文件名的 SHA-256）
- **type**: 元素类型（如 `NarrativeText`、`Title`、`Table` 等）
- **text**: 提取的文本内容
- **metadata**: 元数据信息，常见字段包括：
  - `filename` / `file_directory` / `filetype`
  - `last_modified`
  - `page_number` / `page_width` / `page_height`
  - `coordinates`（8位数组，表示四边形四个点）
  - `parent_id` / `category_depth`
  - `image_base64` / `image_mine_type`
  - `text_as_html`（针对表格）
  - `data_source` （数据源详细信息）

## 返回结果示例

```json
{
    "code": 200,
    "message": "success",
    "x_request_id": "81017abf0fdd3f63ca5c42872cd09a0b",
    "data": {
        "elements": [
            {
                "element_id": "13a9939f23e485ca20a16c741658bcf64efd82309a6f0a8cf35679a65b2fd0dc",
                "type": "NarrativeText",
                "text": "xParse 是一个端到端文档处理 AI 基础设施，致力于将非结构化文档高效转化为可查询、可分析的向量数据资产。",
                "metadata": {
                    "page_number": 1,
                    "page_width": 1191,
                    "page_height": 1684,
                    "parent_id": "23a9939f23e485ca20a16c741658bcf64efd82309a6f0a8cf35679a65b2fd0dc",
                    "category_depth": 1,
                    "coordinates": [217, 390, 1336, 390, 1336, 460, 217, 460],
                    "text_as_html": "<p>...</p>",
                    "filename": "example.pdf",
                    "file_directory": "/projects/demo/",
                    "filetype": "application/pdf",
                    "last_modified": "2024-11-19T14:15:22",
                    "data_source": {
                        "record_locator": {
                            "protocol": "file",
                            "remote_file_path": "/projects/demo/example.pdf"
                        },
                        "url": "file:///projects/demo/example.pdf",
                        "version": "1758624866230967485",
                    }
                }
            },
            // ... more elements
        ]
    },
}
```

更多返回结果示例请参考[文档元素和元数据](/pipeline/elements-metadata)。

## 使用示例

### 示例 1：基础解析配置

```python
from xparse_client import (
    Pipeline,
    LocalSource,
    LocalDestination,
    Stage,
    ParseConfig
)

# 创建数据源
source = LocalSource(
    directory='./documents',
    pattern='*.pdf'
)

# 创建目标存储
destination = LocalDestination(
    output_dir='./output'
)

# 创建解析配置
parse_config = ParseConfig(
    provider='textin',
    parse_mode='auto',
    apply_document_tree=1
)

# 创建 Pipeline
pipeline = Pipeline(
    source=source,
    destination=destination,
    api_base_url='https://api.textin.com/api/xparse',
    api_headers={
        'x-ti-app-id': 'your-app-id',
        'x-ti-secret-code': 'your-secret-code'
    },
    stages=[
        Stage(
            type='parse',
            config=parse_config
        )
    ]
)

pipeline.run()
```

### 示例 2：解析加密 PDF

```python
from xparse_client import ParseConfig

# 创建解析配置，包含 PDF 密码
parse_config = ParseConfig(
    provider='textin',
    pdf_pwd='your-password',  # 提供 PDF 密码
    page_start=1,
    page_count=10
)

# 在 Pipeline 中使用
# pipeline = Pipeline(
#     source=source,
#     destination=destination,
#     stages=[
#         Stage(type='parse', config=parse_config)
#     ],
#     # ... 其他配置
# )
```

### 示例 3：提取图片和表格

```python
from xparse_client import ParseConfig

# 创建解析配置，开启图片和表格提取
parse_config = ParseConfig(
    provider='textin',
    get_image='both',  # 获取整页图像和子图像
    table_flavor='html',  # 表格以 HTML 格式输出
    apply_chart=1  # 开启图表识别
)

# 在 Pipeline 中使用
# pipeline = Pipeline(
#     source=source,
#     destination=destination,
#     stages=[
#         Stage(type='parse', config=parse_config)
#     ],
#     # ... 其他配置
# )
```

### 示例 4：公式识别

```python
from xparse_client import ParseConfig

# 创建解析配置，开启公式识别
parse_config = ParseConfig(
    provider='textin',
    formula_level=0,  # 识别行间公式和行内公式
    apply_merge=1
)

# 在 Pipeline 中使用
# pipeline = Pipeline(
#     source=source,
#     destination=destination,
#     stages=[
#         Stage(type='parse', config=parse_config)
#     ],
#     # ... 其他配置
# )
```

### 示例 5：仅解析特定页面

```python
from xparse_client import ParseConfig

# 创建解析配置，指定解析页面范围
parse_config = ParseConfig(
    provider='textin',
    page_start=5,  # 从第 5 页开始
    page_count=3  # 解析 3 页
)

# 在 Pipeline 中使用
# pipeline = Pipeline(
#     source=source,
#     destination=destination,
#     stages=[
#         Stage(type='parse', config=parse_config)
#     ],
#     # ... 其他配置
# )
```

## 相关文档

- [文档元素和元数据](/pipeline/elements-metadata) - 了解解析后的元素结构
- [分块模块](/pipeline/chunk) - 了解如何对解析后的元素进行分块
- [向量化模块](/pipeline/embed) - 了解如何对元素进行向量化

